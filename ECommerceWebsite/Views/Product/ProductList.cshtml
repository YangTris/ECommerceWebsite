@model AllProductsViewModel

@{
	ViewData["Title"] = "AllProducts";
	Layout = "~/Views/Shared/_Layout.cshtml";
}


<!--MAIN BODY-->
<div id="product-page-body">
	<!--TOP SECTION-->
	<div id="product-top-container">
		<div id="product-top-wrapper">
			<div id="product-top-text-section">
				<h1>Latest Trending</h1>
				<h2>Wirless Headphone</h2>
				<p>
					Lorem Ipsum is simply dummy text
				</p>
				<a href="../Account/Login">
					<button class="blue-button">
						Shop Now
					</button>
				</a>
			</div>
			<div id="product-top-image-section">
				<img src="~/Assets/top_image.png" />
			</div>
		</div>
	</div><!--END TOP SECTION-->
	<!--PRODUCT CATEGORIES-->
	<div id="product-category-container">
		<div id="product-category-text">
			<span class="blue-line"></span>
			<span class="section-category-text">Categories</span>
		</div>
		<div id="product-category-wrapper">
			<div class="product-category">
				<div class="product-category-image-section">
					<img src="~/Assets/product category/all.png" alt="All Categories" />
				</div>
				<div class="product-category-desc-section">
					<span class="product-category-type">
						All
					</span>
					<span class="product-category-number">
						@Html.DisplayFor(model => model.countProduct) Items
					</span>
				</div>
			</div>
			<div class="product-category">
				<div class="product-category-image-section">
					<img src="~/Assets/product category/watch.png" alt="SmartWatch Categories" />
				</div>
				<div class="product-category-desc-section">
					<span class="product-category-type">
						SmartWatch
					</span>
					<span class="product-category-number">
						60 items
					</span>
				</div>
			</div>
			<div class="product-category">
				<div class="product-category-image-section">
					<img src="~/Assets/product category/laptop.png" alt="Laptop Categories" />
				</div>
				<div class="product-category-desc-section">
					<span class="product-category-type">
						Laptop
					</span>
					<span class="product-category-number">
						60 items
					</span>
				</div>
			</div>
			<div class="product-category">
				<div class="product-category-image-section">
					<img src="~/Assets/product category/phone.png" alt="Phone Categories" />
				</div>
				<div class="product-category-desc-section">
					<span class="product-category-type">
						Phone
					</span>
					<span class="product-category-number">
						60 items
					</span>
				</div>
			</div>
			<div class="product-category">
				<div class="product-category-image-section">
					<img src="~/Assets/product category/ipad.png" alt="Tablet Categories" />
				</div>
				<div class="product-category-desc-section">
					<span class="product-category-type">
						Tablet
					</span>
					<span class="product-category-number">
						60 items
					</span>
				</div>
			</div>
			<div class="product-category">
				<div class="product-category-image-section">
					<img src="~/Assets/product category/headphone.png" alt="Tablet Categories" />
				</div>
				<div class="product-category-desc-section">
					<span class="product-category-type">
						Headphone
					</span>
					<span class="product-category-number">
						60 items
					</span>
				</div>
			</div>
		</div>
	</div><!--END PRODUCT CATEGORIES-->
	<!--PRODUCT CARDS-->
	<div class="product-section" id="product-section-all">
		<div class="product-section-top-container">
			<div class="section-category-container">
				<div class="section-category-type">
					<span class="blue-line"></span>
					<span class="section-category-text">All Electronics</span>
				</div>
				<h1>Explore Your Favorite</h1>
			</div>
		</div>

		<div class="product-cards-container">
			<ul>
				@foreach (var item in Model.products)
				{
					<li class="product-card">
						<a asp-action="ProductDetails" asp-route-productId="@item.productId" class="product-link">
							<div class="product-image-container">
								<img src="~/Assets/watch.png" />
							</div>
							<div class="product-text-container">
								<h1>@Html.DisplayFor(modelItem => item.name)</h1>
								<div class="product-purchase">
									<span class="product-price">@Html.DisplayFor(modelItem => item.price)$</span>
									<form method="post" asp-controller="Cart" asp-action="Add" asp-route-productId="@item.productId" asp-route-quantity="1">
										<button type="submit" id="blue-button-card">
											Add to cart
										</button>
									</form>
								</div>
							</div>
						</a>
					</li>
				}
			</ul>
		</div>
		<!-- Pagination buttons -->
		<div class="pagination-container">
			<button id="prev" disabled>Previous</button>
			<span id="page-info">Page 1</span>
			<button id="next">Next</button>
		</div>
	</div>
</div>

<script>
	document.addEventListener("DOMContentLoaded", function () {
		const productsPerPage = 6;
		const productList = document.querySelectorAll('.product-card');
		const totalProducts = productList.length;
		let currentPage = 1;


		function displayPage(page) {
			const start = (page - 1) * productsPerPage;
			const end = start + productsPerPage;

			productList.forEach((product, index) => {
				product.style.display = 'none';
			});

			for (let i = start; i < end && i < totalProducts; i++) {
				productList[i].style.display = 'block';
			}
			document.getElementById('page-info').innerText = `Page ${currentPage}`;
			document.getElementById('prev').disabled = currentPage === 1;
			document.getElementById('next').disabled = end >= totalProducts;
		}

		document.getElementById('prev').addEventListener('click', function () {
			if (currentPage > 1) {
				currentPage--;
				displayPage(currentPage);
			}
		});

		document.getElementById('next').addEventListener('click', function () {
			if ((currentPage * productsPerPage) < totalProducts) {
				currentPage++;
				displayPage(currentPage);
			}
		});

		displayPage(currentPage);
	});

	// document.querySelectorAll('.blue-button').forEach(button => {
	// 	button.addEventListener('click', function (event) {
	// 		event.preventDefault();
	// 	});
	// });

	$(document).ready(function () {
		$('.add-to-cart').click(function () {
			var productId = $(this).data('product-id');
			var quantity = $(this).data('quantity');

			$.ajax({
				url: '@Url.Action("Add", "Cart")',
				type: 'POST',
				data: { productId: productId, quantity: quantity },
				success: function (response) {
					console.log('Product added to cart!');
				},
				error: function (xhr, status, error) {
					console.log('Failed to add product to cart: ' + error);
				}
			});
		});
	});

</script>



